{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function fetchImages(userQuery, currentPage) {\n    const API_KEY = \"42441384-ae09b834f94a4016fb8b80a97\";\n    const BASE_URL = \"https://pixabay.com\";\n    const END_POINT = \"/api/\";\n    const url = BASE_URL + END_POINT;\n    \n    const params = {\n        key: API_KEY,\n        q: userQuery,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        per_page: 15,\n        page: currentPage,\n    };\n\n    const res = await axios.get(url, { params });\n    return res.data;\n}","function imgTemplate(image) {\n    const { largeImageURL, webformatURL, tags, likes, views, comments, downloads } = image;\n    return `<li class=\"gallery-item\">\n        <a class=\"gallery-link\"\n            href=\"${largeImageURL}\">\n            <img class=\"gallery-image\"\n                src=\"${webformatURL}\"\n                alt=\"${tags}\" />\n        </a>\n        <div class = \"gallery-item-info\">\n                <ul>Likes<li>${likes}</li></ul>\n                <ul>Views<li>${views}</li></ul>\n                <ul>Comments<li>${comments}</li></ul>\n                <ul>Downloads<li>${downloads}</li></ul>\n        </div>\n    </li>`\n}\n\nexport function galleryTemplate(images) {\n    return images.map(imgTemplate).join(\"\");\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { fetchImages } from './js/pixabay-api';\nimport { galleryTemplate } from './js/render-functions';\n\nconst refs = {\n    formElem: document.querySelector(\".form\"),\n    galleryElem: document.querySelector(\".gallery\"),\n    loaderElem: document.querySelector(\".loader\"),\n    loadMoreBtnElem: document.querySelector(\".load-more-btn\"),\n}\nlet userQuery;\nlet page;\nlet maxPage;\n\nconst lightbox = new SimpleLightbox(\".gallery-link\", { captionsData: \"alt\", captionDelay: 250 });\n\nrefs.formElem.addEventListener(\"submit\", onFormSubmit);\nrefs.loadMoreBtnElem.addEventListener(\"click\", onLoadMoreBtnClick);\n\nasync function onFormSubmit(event) {\n    event.preventDefault();\n    refs.galleryElem.innerHTML = \"\";\n    page = 1;\n    maxPage = 0;\n    checkBtnVisibleStatus();\n    userQuery = event.target.elements.query.value.trim();\n    event.target.reset();\n    if (!userQuery) {\n        showError(\"Please enter a search query\");\n        return;\n    }\n    showLoader();\n    try {\n        const data = await fetchImages(userQuery, page);\n        if (data.hits.length === 0) {\n            showError(\"Sorry, there are no images matching your search query. Please try again!\"); \n        }\n        maxPage = Math.ceil(data.totalHits / 15);\n        renderGallery(data.hits);\n    } catch (err) {\n        showError(err.message);\n        maxPage = 0;\n        refs.galleryElem.innerHTML = \"\";\n    }\n    hideLoader();\n    checkBtnVisibleStatus()\n}\n\nasync function onLoadMoreBtnClick() {\n    page += 1;\n    hideLoadMoreBtn();\n    showLoader();\n    const data = await fetchImages(userQuery, page);\n    renderGallery(data.hits);\n    hideLoader();\n    checkBtnVisibleStatus();\n\n    const height = refs.galleryElem.firstElementChild.getBoundingClientRect().height * 2;\n    scrollBy({\n        behavior: \"smooth\",\n        top: height,\n    });\n}\n\nfunction renderGallery(data) {\n    const markup = galleryTemplate(data);\n    refs.galleryElem.insertAdjacentHTML(\"beforeend\", markup);\n    lightbox.refresh();\n}\nfunction showLoadMoreBtn() {\n    refs.loadMoreBtnElem.classList.remove(\"visually-hidden\");\n}\nfunction hideLoadMoreBtn() {\n    refs.loadMoreBtnElem.classList.add(\"visually-hidden\");\n}\nfunction checkBtnVisibleStatus() {\n    if (page === maxPage) {\n        showMessage(\"We're sorry, but you've reached the end of search results.\");\n        hideLoadMoreBtn();\n    } else if (page >= maxPage) {\n        hideLoadMoreBtn();\n    } else {\n        showLoadMoreBtn();\n    }\n}\nfunction showLoader() {\n    refs.loaderElem.classList.remove(\"visually-hidden\");\n}\nfunction hideLoader() {\n    refs.loaderElem.classList.add(\"visually-hidden\");\n}\nfunction showError(err) {\n    iziToast.error({\n        title: \"\",\n        message: err,\n        position: 'topCenter',\n    });\n}\nfunction showMessage(message) {\n    iziToast.show({\n        title: \"\",\n        message: message,\n        position: 'bottomCenter',\n    });\n}"],"names":["fetchImages","userQuery","currentPage","API_KEY","url","params","axios","imgTemplate","image","largeImageURL","webformatURL","tags","likes","views","comments","downloads","galleryTemplate","images","refs","page","maxPage","lightbox","SimpleLightbox","onFormSubmit","onLoadMoreBtnClick","event","checkBtnVisibleStatus","showError","showLoader","data","renderGallery","err","hideLoader","hideLoadMoreBtn","height","markup","showLoadMoreBtn","showMessage","iziToast","message"],"mappings":"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"}